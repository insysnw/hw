
# НЕблокирующий (асинхронный) TCP чат

Написан на Python (3.7)

В данном случае используются **Корутины** (для асинхронной обработки запросов от клиентов) и НЕблокирующие сокеты

### Запуск

Сервер: `python TCP_chat_server_async.py`

Клиент: `python TCP_chat_client.py`

### Формат пакета

`Time(5 + 6 + 6 = 17) | Length_name(6) | Flag_file(1) | Name(Length_name * 8) | Message(n)`

`Time` - Время отправки сообщения (UTC): часы(5), минуты(6), секунды(6)

`Length_name(6)` - Длина имени клиента (в байтах)

`Flag_file(1)` - Флаг передачи файла: 0 - "обычное" сообщение, 1 - файл

`Name(Length_name * 8)` - Имя (nickname) клиента / пользователя

`Message(n)` - Передаваемое сообщение (или файл)

### Протокол

Подразумевает следующую последовательность действий:

1). **Установка соединения** может быть только 1-м, в остальных ситуациях не является корректным.   
2). **Передача сообщений между клиентами** выполняется в любой момент времени между **Установкой соединения** и **Завершением соединения**.   
3). **Завершение соединения** может быть выполнено только после **Установки соединения**.

Переход от 1-го Действия ко 2-му выполняется только после установления сервером корректности имени клиента.   
Последнее действие выполняется по команде пользователя.

Если предложенное имя пользователя уже используется, сервер сообщит этому клиенту о необходимости изменить свой nickname.

При подключении нового клиента к серверу всем пользователям отправляется сообщение:
`[time]  <name> joined the chat!`   
При отключении клиента от сервера:
`[time]  <name> exited from the chat!`

### Команды

Клиент может использовать следующие команды:

1). `-f`, `--file` - для передачи файла   
2). `-q`, `--quit`, `exit` - для завершения соединения
